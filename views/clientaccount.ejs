<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lawyers-Legal Reach</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="icon" type="image/png" href="../uploads/logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.1.0/remixicon.css">   
    <link rel="stylesheet" href="clientprofile.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Roboto+Slab&display=swap" rel="stylesheet">
  
</head>
<body>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <%- include('partials/header') %>
    
   <div class="body"> 
    <div class="main-body">
      
            <div class="client-profile-container-0">
                <div class="client-profile-container">
                    <div class="profile-container">
                        
                        <!-- <div class="img-edit-box">
                            <div class="img-container">
                                <div class="img-box">
                                    <img src="<%= user.image %>" alt="">
                                </div>
                            </div>
                            <div class="edit-profile">
                                <div class="edit-btn">
                                    <span> Edit Profile </span>
                                     <i class="fa-regular fa-pen-to-square"></i>
                                   </div>
                            </div>
                            <div class="logout-btn">
                              <span> Logout </span>
                              <i class="fa-solid fa-right-from-bracket"></i>
                             </div>
                        </div> -->

                        <div class="name-bio-contact-box">
                            <div class="name-box">
                              <div class="name">
                               <h2><span><%= user.name %></span></h2> 
                              </div>
                             </div>
                             <div class="button-contact">
                                <!-- <div class="bio">
                                    <h5>Bio -</h5>
                                    <p>
                                     Lorem ipsum dolor sit amet consectetur adipisicing elit. Tempora eaque veritatis voluptatum tenetur, facilis fugiat commodi quibusdam quod repudiandae, ea accusamus dolorum voluptatem molestiae vel, quam in animi quaerat.Lorem ipsum dolor sit amet consectetur, adipisicing elit. Nobis maxime tempore explicabo neque beatae mollitia non possimus accusamus laudantium. Sequi.
                                     </p>
                                  </div> -->
                                <div class="buttons">
                                    <div class="edit-profile">
                                        <div class="edit-btn">
                                            <span> Edit Profile </span>
                                             <i class="fa-regular fa-pen-to-square"></i>
                                           </div>
                                    </div>
                                    <div class="logout-btn">
                                      <span> Logout </span>
                                      <i class="fa-solid fa-right-from-bracket"></i>
                                     </div>
                                </div>
                                  <div class="contact-box">
                                    <div class="contact-title">
                                        <h5>Contact -</h5>
                                    </div>
                                    <div class="contact">
                                    <div class="phone-no"><span><%= user.c_no %></span></div>
                                    <div class="email"><span><%= user.email %></span></div>
                                   
                                    </div>
                                </div>
                            </div>
                                
                            
    
                             </div> 
                             
                    </div>
    
       
        


                <div class="form-container-0">
                    <div class="form-container"> 
                        <a href="#" class="close">&times;</a>
                        <div class="form-headings">
                         <h2>Enter details to update</h2>
                        </div>
                        <div class="wrapper">
                            <form action="/userAccount" id="user-account-form" method="post" enctype="multipart/form-data">
                                <div class="input-fields">
                                    <div class="input-field">
                                        <input type="text" name="name" id="update-name" placeholder="Name">
                                      </div>
                                      <div class="input-field if-field if-password">
                                        <input type="password" name="passw" id="update-password" placeholder="Password">
                                        <i id="toggle-password" class="fas fa-eye-slash"></i>
                                      </div>
                                      <div class="input-field if-field if-password">
                                        <input type="password" name="cpassw" id="co-password" placeholder="Confirm Password">
                                        <i id="toggle-co-password" class="fas fa-eye-slash"></i>
                                      </div>
                                
                                    <div class="input-field if-field">
                                        <input type="tel" name="c_no" id="update-phone" placeholder="update Phone No">
                                    </div>
                                    <div class="input-field if-field">
                                        <input type="email" name="email" id="update-email" placeholder="update Email">
                                    </div>
                                 
                                </div>
                                <div class="btn-container">
                                    <div class="btn-layer"></div>
                         <input type="submit" value="Submit" class="submit-btn" id="details-submit-btn">
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="logout-form-container">
                  <form id="log-out" action="/logOut" method="post">
                  <div class="logout-form">
                     <div class="logout-heading">
                      <h2>Do you want to logout ?</h2>
                     </div>
                     <div class="yes-no-btn">
                      <div class="yes-btn">
                          <button  type="submit" id="yes-button">Yes</button>
                      </div>
                      <div class="no-btn">
                          <button id="no-button">No</button>
                      </div>
                     </div>
                  </div>
                  </form>
              </div>
            </div>
         </div>
     </div>
    
    <%- include('partials/footer') %>
   </div>

<script>
    document.addEventListener('DOMContentLoaded',()=>{
    const form = document.getElementById('user-account-form');
    form.addEventListener('submit',async(event)=>{
        event.preventDefault();
        const formData = new FormData(form);
        try{
            const response = await fetch('/userAccount',{
                method: 'POST',
                body:  formData
            });
        const data = await response.json();
        Toastify({
            text: data.message,
            duration: 1500,
            close: true,
            gravity: "top",
            position: "center",
            backgroundColor: data.success? "#4CAF50":"FF0000",
        }).showToast();

        if(data.success){
            setTimeout(()=>{
                window.location.href='/userAccount';
            },1000);
        }
        } catch(error){
            console.error('Error:', error);
            Toastify({
            text: "An error occurred. Please try again.",
            duration: 3000, 
            close: true, 
            gravity: "top", 
            position: "center", 
            backgroundColor: "#FF0000", 
          }).showToast();
        }
    })

    const form1 = document.getElementById('log-out');
    form1.addEventListener('submit',async(event)=>{
        event.preventDefault();
        const formData = new FormData(form);
        try{
            const response = await fetch('/logOut',{
                method: 'POST',
                body:  formData
            });
        const data = await response.json();
        Toastify({
            text: data.message,
            duration: 3000,
            close: true,
            gravity: "top",
            position: "center",
            backgroundColor: data.success? "#4CAF50":"FF0000",
        }).showToast();

        if(data.success){
            setTimeout(()=>{
                window.location.href='/signup';
            },1000);
        }
        } catch(error){
            console.error('Error:', error);
            Toastify({
            text: "An error occurred. Please try again.",
            duration: 3000, 
            close: true, 
            gravity: "top", 
            position: "center", 
            backgroundColor: "#FF0000", 
          }).showToast();
        }
    })
})
    const showmenu=(toggleId, navId) =>{
    const toggle = document.getElementById(toggleId),
          nav=document.getElementById(navId);

          toggle.addEventListener('click',()=>{
               nav.classList.toggle('show-menu');
               toggle.classList.toggle('show-icon');

          })

}
showmenu('nav-toggle','nav-menu');

const dropdownItems = document.querySelectorAll('.dropdown-item')

dropdownItems.forEach((item)=>{
    const dropdownButton= item.querySelector('.dropdown-button');
    
    dropdownButton.addEventListener('click',()=>{
         const showDropdown= document.querySelector('.show-dropdown')

         toggleItem(item);

         if(showDropdown && showDropdown!==item){
           toggleItem(showDropdown)
         }
    })
})

const toggleItem = (item) =>{
     const dropdownContainer = item.querySelector('.dropdown-container');
     
     if(item.classList.contains('show-dropdown')){
          dropdownContainer.removeAttribute('style');
          item.classList.remove('show-dropdown');
     }
     else{
         
     dropdownContainer.style.height=dropdownContainer.scrollHeight +'px';
     item.classList.add('show-dropdown'); 
     }


    
}
const mediaQuery=matchMedia('(min-width:1118px)'),
 dropdownContainer=document.querySelectorAll('.dropdown-container')

 const removeStyle=()=>{
     if(mediaQuery.matches){
          dropdownContainer.forEach((e)=>{
             e.removeAttribute('style');
          })

          dropdownContainer.forEach((e)=>{
               e.classList.remove('show-dropdown');
            })
          
     }
 }
 addEventListener('resize',removeStyle);

 const formContainer0=document.querySelector(".form-container-0");
 const edit=document.querySelector(".edit-btn");
 const close=document.querySelector(".close");

 edit.onclick=()=>{
  formContainer0.classList.add('form-active');
 }
 close.onclick=()=>{
  formContainer0.classList.remove('form-active');
 }

const togglePassword=document.getElementById("toggle-password");
const toggleCoPassword=document.getElementById("toggle-co-password");
const  passwordField= document.getElementById("update-password");
const confirmPassword=document.getElementById("co-password");

togglePassword.addEventListener("click" , ()=>{
  if (passwordField.type === "password") {
    passwordField.type = "text";
  } else {
    passwordField.type = "password";
  }
  togglePassword.classList.toggle('fa-eye');

})
toggleCoPassword.addEventListener("click" , ()=>{
  if (confirmPassword.type === "password") {
    confirmPassword.type = "text";
  } else {
    confirmPassword.type = "password";
  }
  toggleCoPassword.classList.toggle('fa-eye');

})

const logoutformcontainer=document.querySelector(".logout-form-container");
 const logoutBtn=document.querySelector(".logout-btn");
 const noBtn=document.getElementById("no-button");
 logoutBtn.onclick=()=>{
    logoutformcontainer.classList.add('logout-form-active');
 }
 noBtn.onclick=()=>{
    logoutformcontainer.classList.remove('logout-form-active');
 }

</script>
       
</body>
</html>