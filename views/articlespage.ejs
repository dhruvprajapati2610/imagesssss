<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lawyers-Legal Reach</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.1.0/remixicon.css">   
    <link rel="stylesheet" href="articlespage.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="icon" type="image/png" href="../uploads/logo.png">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Roboto+Slab&display=swap" rel="stylesheet">
  
</head>
<body>
    <%- include('partials/header') %>
   <div class="body">
        <div class="main-body">
          <div class="search-box-container">
            <div class="search-box">
             <form action="/search-articles" method="get">
               <input type="search" name="search" placeholder="Search articles" id="search-bar">
               <button class="searchbtn" id="search-button"><i class="fa-solid fa-magnifying-glass"></i></button>
               </form>
            </div>
          </div>
          <div class="articles-container-0">
            <div class="articles-container">
              <% if(noResults) { %>
                <p class="law-title">No results found</p>
            <%  } else { %>
                <% articles.forEach(article=>{ %>
                <div class="article-box">
                    <div class="img-btn-container">
                        <div class="img-container">
                            <div class="img-box">
                                <img src="Article.png" alt="">
                            </div>
                        </div>
                        <div class="btn-container">
                        
                            <button class="article-btn" data-article-id="<%=article.id%>" value="contact">Read More &nbsp;&nbsp;<i class="fa-solid fa-angles-right"></i></button>
                         
                        </div>
                    </div>
                    <div class="name-rating-container">
                      
                        <div class="article-title">
                            <div class="title"><span ><%= article.title %></span></div>
                           
                        </div>
                        <div class="name-rating">
                            <div class="lawyer-name">
                                <span class="wb-title">written by - </span>
                                <span class="wb-name"><%= article.author_name %></span>
                            </div>
                          

                        </div>
                        <div class="article-desc">
                            <div class="desc-container">
                              <div>
                            <p><%-article.content %></p>
                          </div>
                            </div>
                            <div class="like-container">
                                <span><i class="fa-solid fa-thumbs-up"></i>&nbsp; <%=article.likes%> </span>
                            </div>
                        </div>
                    </div>
                </div>
                <% }) %>
                <% } %>
                         

            </div>
            <!-- <div class="slide-menu">
                <div class="btn-box pre" id="btnbox-1"><i class="fa-solid fa-angles-right"></i></div>
                <div class="btn-box" id="btnbox-2"><span>1</span></div>
                <div class="btn-box" id="btnbox-3"><span>2</span></div>
                <div class="btn-box" id="btnbox-4"><span>3</span></div>
                <div class="btn-box" id="btnbox-5"><span>4</span></div>
                <div class="btn-box next" id="btnbox-6"><span><i class="fa-solid fa-angles-right"></i></span></div>
              </div>   -->
              <div id="paginationContainer" data-current-page="<%=currentPage%>" class="pagination slide-menu">
                <% if(currentPage>1) {%>
                  <div class="btn-box prev"  class="prev-btn" onclick="window.location.href='?page=<%= currentPage - 1 %>&limit=<%= limit %>'"><span><i class="fa-solid fa-angles-left"></i></span></div>
                  <% } %>
                <% for(let i=1;i<= totalPages;i++) { %>
                   <div class="btn-box"  onclick="window.location.href='?page=<%= i %>&limit=<%= limit %>'" class="<%= i === currentPage ? 'active' : '' %>"><%= i %></button> </div>
                  <% } %>
                <% if(currentPage< totalPages) { %>
                  <div class="btn-box next" class="next-btn" onclick="window.location.href='?page=<%= currentPage + 1 %>&limit=<%= limit %>'"><span><i class="fa-solid fa-angles-right"></i></span></div>
                  <% } %>
               
            </div> 
          </div>
         </div>
         <%- include('partials/footer') %>
        </div>
<script>
    const showmenu=(toggleId, navId) =>{
    const toggle = document.getElementById(toggleId),
          nav=document.getElementById(navId);

          toggle.addEventListener('click',()=>{
               nav.classList.toggle('show-menu');
               toggle.classList.toggle('show-icon');

          })

}
showmenu('nav-toggle','nav-menu');

const dropdownItems = document.querySelectorAll('.dropdown-item')

dropdownItems.forEach((item)=>{
    const dropdownButton= item.querySelector('.dropdown-button');
    
    dropdownButton.addEventListener('click',()=>{
         const showDropdown= document.querySelector('.show-dropdown')

         toggleItem(item);

         if(showDropdown && showDropdown!==item){
           toggleItem(showDropdown)
         }
    })
})

const toggleItem = (item) =>{
     const dropdownContainer = item.querySelector('.dropdown-container');
     
     if(item.classList.contains('show-dropdown')){
          dropdownContainer.removeAttribute('style');
          item.classList.remove('show-dropdown');
     }
     else{
         
     dropdownContainer.style.height=dropdownContainer.scrollHeight +'px';
     item.classList.add('show-dropdown'); 
     }


    
}
const mediaQuery=matchMedia('(min-width:1118px)'),
 dropdownContainer=document.querySelectorAll('.dropdown-container')

 const removeStyle=()=>{
     if(mediaQuery.matches){
          dropdownContainer.forEach((e)=>{
             e.removeAttribute('style');
          })

          dropdownContainer.forEach((e)=>{
               e.classList.remove('show-dropdown');
            })
          
     }
 }
 addEventListener('resize',removeStyle);

 document.addEventListener('DOMContentLoaded', () => {
 const viewArticleButtons = document.querySelectorAll('.article-btn');
 viewArticleButtons.forEach(button=>{
  button.addEventListener('click',async(event)=>{
    const articleId = event.target.dataset.articleId;
    try{
      const response = await fetch(`/fullarticle?articleId=${articleId}`,{
        method: 'GET',
        headers: {
          'Content-type': 'application/json'
        },
        // body: JSON.stringify({ lawyerId })
      })
      if(response.ok){
        window.location.href = `/fullarticle?articleId=${articleId}`;
      } else {
        const errorData = await response.json();
        console.error('Error fetching full article:', errorData);
      }
    } catch(error){
      console.error('error:',error);
    }
  })
 })
});
 
</script>
       
</body>
</html>